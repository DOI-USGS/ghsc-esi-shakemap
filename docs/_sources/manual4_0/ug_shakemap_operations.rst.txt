.. _ug-sec-shakemap-operations-4:

*******************
ShakeMap Operations
*******************

In the U.S., ShakeMaps are generated via independent systems running at
ANSS Regional Seismic Systems (RSNs) in Northern California, Southern
California, the Pacific Northwest, Utah, Nevada, and Alaska. For the rest
of the U.S., the ShakeMap group at the USGS National Earthquake Information
Center (NEIC) in Golden, Colorado produces maps for the regional networks
operating in Hawaii, New England, and the Central and Eastern U.S., on a
system referred to as Global ShakeMap (GSM). The input, metadata, and
output files produced by all these instances are aggregated by the USGS
via the Earthquake Hazards Program web system. GSM also provides backup
capabilities for the RSNs, but sometimes with degraded capabilities since
not all data are flowing from the RSNs to GSM automatically.

Separate independent systems running at RSNs in Puerto Rico, Texas, and
New England generate ShakeMaps, but these instances do not deliver them
through the USGS Earthquake Hazards Program webpages (at the time of this
writing). GSM covers these regions but does not access the full set of data
collected by these regional systems. For example, Puerto Rico significantly
upgraded the seismic network in 2020 but not all strong motion stations
are yet telemetered in real-time.


ShakeMap Triggering Thresholds
==============================

Global ShakeMap (GSM) is triggered by any earthquake of M5.4 or larger
globally as determined from earthquake parameters by the Earthquake
Information Center (NEIC). Additionally, GSM is generated at lowering
thresholds for each RSN region, usually with a magnitude threshold of
3.5, to mirror the triggering by RSN ShakeMaps. 

However, these GSM triggering thresholds in RSN, and RSN ShakeMap thresholds
are not necessarily fixed. Triggering thresholds may be adjusted
short-term in the case of earthquake clusters or numerous aftershocks,
or long-term based on operational considerations. Additionally, each
ShakeMap operator may trigger a ShakeMap for a lower magnitude earthquake
if the event is of interest, whether widely felt, damaging, or is of
scientific interest.


.. _subsec-sources-versions:


ShakeMap Sources, Authoritativeness, and Versions
=================================================

Since there are potentially multiple ShakeMaps, users must use caution
in their use. An earthquake may have alternative ShakeMaps generate by
different sources such as GSM, or an RSN. Additionally, ShakeMaps evolve
over time, particularly in the minutes and hours immediately after an
earthquake; these generate new ShakeMap versions.


ShakeMap Sources and Authoritativeness
--------------------------------------

All events are likely to have GSM-generated ShakeMap (source=US). Global
earthquakes have only one source: GSM. However, for an earthquake in,
say, Northern California, one ShakeMap will be produced by GSM and anther
will be generated by the RSN, in this case the Northern California Seismic
Network (source=NC). In addition, in California, the California Geological
(CGS) also generates a ShakeMap for California Integrated Seismic Network
(CISN) backup purposes. Complicated? Just wait.

For any earthquake product, like ShakeMap layers, or the earthquake
hypocenter and magnitude (the origin), there is one that is deemed
“authoritative”. For ShakeMap, the RSN ShakeMap is deemed authoritative,
unless it does not arrive after a fixed number of minutes, in which case
the next-to-authoritative source will become temporarily authoritative. 

All real-time earthquake products, including ShakeMaps, are transferred
via the Product Distribution Layer (PDL) to USGS’ Comprehensive Catalog
(ComCat) database. PDL tags each product with a level of authoritativeness,
such that they can be used and displayed online in an organized and
systematic fashion.  All maps are available via ComCat and the event’s
ShakeMap webpage. For example, in :num:`Figure #figure-authoritativeness`,
Utah’s RSN ShakeMap
(source=UU) is authoritative yet the GSM ShakeMap (source=US) is also
available. 

.. note::
   Different ShakeMap sources will produce (hopefully only) slightly
   different maps, depending on the data available to that source, the
   version of ShakeMap being run, and a host of operator-specific
   configurations, like which Ground Motion Model(s) are being used (see
   :ref:`sec_disclaimers-4`).
   Additionally, RSNs tend to not automatically incorporate USGS Did You
   Feel It? (DYFI) data, whereas GSM by default always uses DYFI data.
   The use of, or lack thereof, DYFI data can result in rather different
   maps particularly for events that have more DYFI data than seismic
   stations. The influence of the DYFI data affect different ShakeMap IM
   layers more or less depending on a number of factors related to their
   uncertainties (See :ref:`Worden et al., 2018 <worden2018>`).

This warrants an addition disclaimer: Any ShakeMap is simply a model of
the ground shaking field; different data sets or different processing
assumptions will result in different models; there is no unique solution
nor ShakeMap. Upon request, USGS can regenerate a ShakeMap with or
without DYFI, for example, and we may begin generating two sets of maps
systematically if there is sufficient demand to do so. 

.. _figure-authoritativeness:

.. figure:: _static/utah_event_authoritative.*
   :align: left
   :width: 650px

   Portion of a
   `ShakeMap webpage <https://earthquake.usgs.gov/earthquakes/eventpage/uu60363602/shakemap/>`_
   showing the Utah (uu) and NEIC/GSM (us) versions of the event.


ShakeMap Versions
-----------------

In addition to multiple possible sources of ShakeMaps for a given event,
each source will likely update the ShakeMaps in the immediate minutes
and hours after an earthquake. For global earthquakes, GSM (“US”) will
be the only ShakeMap source, yet there may be several updates (new
versions) of the GSM ShakeMap. By default, GSM will generate Version 1
at the time of triggering from a US origin solution, that is when the
event hypocenter and magnitude are released by NEIC. Without other
modifications, GSM will then rerun two hours after the origin time.
However, GSM will also rerun conditionally, if the event origin is
revised, or if new seismic data arrive.

RSN retriggering is often more complex, and numerous reruns and resulting
Version updates will be produced. For example, as seen in the lower left
of :num:`Figure #figure-authoritativeness`, the authoritative ShakeMap
from Utah (UU) is on version 5.

Whereas all ShakeMaps from different sources can be access from this
web portal, only the more recent version of the ShakeMap products are
available. To access earlier versions of any ShakeMap products on can
use the *getproduct* function of the library libcomcat to query the
ComCat database (see :ref:`subsec-comcat`).


ShakeMap Updating Policy
========================

ShakeMaps are preliminary in nature and will be updated as data arrive
from a variety of distributed sources. Our strategy is to update ShakeMaps
as warranted from a scientific perspective. We reserve the option to
update ShakeMaps as needed to add data or to improve scientific merit
and/or presentation of the maps in any way beneficial. This most typical
update is after new data arrive, finite-fault models get established or
revised, magnitude gets revised, or as improved site amplification maps,
ground motion prediction equations, or even interpolation or other
procedures become available.

**There is no formal “final” version of any ShakeMap.** All versions of all
products are permanently archived in the USGS ComCat database. ShakeMap
version numbers and timestamps are provided on the maps, webpages, grid
files, and metadata.

Our practice is to improve the maps as soon as possible, but there are
factors beyond our control that can result in delayed updates. For
regions around the world, where there are insufficient near–real-time
strong-motion seismic stations to generate an adequate
strong-ground-motion data-controlled ShakeMap, we can still provide a
very useful estimate of the shaking distribution using the ShakeMap
software. Site amplification is approximated from a relationship
developed between topographic gradient and shear-wave velocity.
Additional constraints for these predictive maps come primarily from
additional earthquake source information, particularly fault rupture
dimensions, observed macroseismic intensities (including via the USGS
“Did You Feel It?” system), and observed strong ground motions, when
and where available.

For perspective, consider ShakeMap update examples for some significant
earthquakes:

* For the very deadly 2008 Wenchuan, China, earthquake, the Chinese
  strong-motion data were not made available for several months.
* For the 2011 Tohoku, Japan earthquake, the magnitude was updated from
  7.9 to 8.9 over the course of the first hour after origin time. The
  Japanese strong-motion data processing center was impacted by the
  earthquake, yet they provided data for nearly a thousand seismic
  stations within several days after the earthquake. These vital data
  were added to the ShakeMap as soon as they became available.
* Due to telemetry limitations, some important seismic station data for
  the 2014 American Canyon, California, earthquake came in minutes,
  hours, and as late as four days after the event. The data were added
  to the ShakeMap soon after they were received and processed. The
  magnitude also changed from an initial M5.7 to M6.0, and this, too,
  affected the ShakeMap. Lastly, the causative fault location was added
  by the Northern California ShakeMap operators several days after the
  earthquake.

**Updates to Online Maps**

* **Real-time ShakeMap Updates.** Changes can be tracked with the ShakeMap
  version numbers and timestamps found in the metadata, the info.json and
  grid.xml files, and on the maps themselves (time generated). The
  info.json file contains timestamps, number of stations used, GMPE
  information, and many other attributes that could have changed from
  version to version. Often a text statement is provided that notes
  significant changes for a particular version.
* **ShakeMap Atlas Updates.** The ShakeMap Atlas uses version numbers for
  each Atlas event; the overall Atlas collection is also Versioned.
  Currently ShakeMap Atlas Version 4.0 is online in the ComCat database,
  and the older Atlas (Version 2.0) can be found via database query
  tools (*getproduct* and the libcomcat library).
* **Scenario Revisions.** ShakeMap Scenario collections uses version
  numbers for each event; the overall scenario collection is named
  according to their source. Some older scenarios are online on the
  `legacy ShakeMap Archives pages <http://earthquake.usgs.gov/earthquakes/shakemap/>`_.
  Scenario ShakeMaps will be revised
  when the underlying probabilistic seismic map fault segmentation or
  other particulars (like GMPE selection) change. Older versions will
  be archived in ComCat (see :ref:`subsec-comcat`).

